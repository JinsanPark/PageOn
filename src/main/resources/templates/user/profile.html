<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>User Information</title>
    <!-- Bootstrap 5 CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/sub.css" rel="stylesheet">
</head>

<style>
    /* 페이지를 전체 높이로 설정하여 푸터가 하단에 고정되도록 설정 */
    html, body {
        height: 100%;
        margin: 0;
        display: flex;
        flex-direction: column;
    }
    /* 콘텐츠와 푸터를 감싸는 래퍼 */
    .content-wrapper {
        flex: 1;
    }

    /* 사용자 정보 스타일 */
    .user-info h4 {
        font-size: 1.5rem;
        margin-bottom: 10px;
    }
    .user-info p {
        margin-bottom: 5px;
        color: black;
    }
    /* introduce 스타일 */
    .user-introduce {
        height: 150px;
        overflow-y: auto;
        border: 1px solid #dee2e6;
        padding: 10px;
        border-radius: 4px;
        background-color: #f8f9fa;
    }
    /* 카드 스타일 */
    .card {
        border: none;
        border-radius: 8px;
        box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
        height: 100%;
        display: flex;
        flex-direction: column;
    }
    .card-body {
        flex-grow: 1;
    }
    .more-link {
        float: right;
        text-decoration: underline;
        color: #007bff;
    }
    /* 리스트와 버튼 스타일 */
    .list-group-item {
        transition: background-color 0.3s;
        color: black;
    }
    .btn {
        transition: background-color 0.3s;
    }
    .btn-primary {
        background-color: #007bff;
    }
    .btn-primary:hover {
        background-color: #0056b3;
    }
    .btn-secondary {
        background-color: #6c757d;
    }
    .btn-secondary:hover {
        background-color: #5a6268;
    }
    /* 카드 텍스트 색상 변경 */
    .card-text {
        color: black;
    }
</style>

<body>
<header th:replace="~{header :: header}"></header>

<div class="content-wrapper">
    <div class="container my-4">
        <div class="row">
            <!-- 왼쪽 박스: 프로필 이미지와 사용자 정보 함께 표시 -->
            <div class="col-md-4 col-sm-12 mb-4">
                <div class="card border-custom p-4 d-flex flex-column" style="height: 100%;">
                    <div class="d-flex align-items-start mb-3">
                        <div class="me-4">
                            <img th:src="${userVO.imgDataAsBase64}" alt="User Image" width="100" height="100"/>
                        </div>
                        <div class="user-info">
                            <h4>User Information</h4>
                            <p><strong>ID:</strong> <span th:text="${userVO.id}"></span></p>
                            <p><strong>Name:</strong> <span th:text="${userVO.name}"></span></p>
                            <p><strong>Tel:</strong> <span th:text="${userVO.tel}"></span></p>
                            <a th:if="${session.id != 'admin'}" class="btn btn-info btn-sm" href="/user/updateProfile">수정하기</a>
                        </div>
                    </div>
                    <div class="user-introduce mt-auto">
                        <h5>Introduce:</h5>
                        <span th:text="${userVO.introduce}"></span>
                    </div>
                </div>
            </div>

            <!-- 카테고리 박스 -->
            <div class="col-md-4 col-sm-12 mb-4">
                <div class="card border-custom p-1" style="height: 100%;">
                    <h5>Categories</h5>
                    <div class="border p-3 mb-3" style="max-height: 300px; overflow-y: auto;">
                        <div class="row">
                            <div class="col-6 col-md-4" th:each="category : ${categories}">
                                <div class="card mb-3" style="height: 50px;">
                                    <div class="card-body" style="font-size: 0.7rem;">
                                        <text>#</text> <span th:text="${category}"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <a th:if="${session.id != 'admin'}" class="btn btn-secondary mt-2" href="/user/updateCategoriesPage">카테고리 수정하기</a>
                </div>
            </div>

            <div class="col-md-4 col-sm-12 mb-4">
                <div class="card border-custom p-1" style="height: 100%; padding: 10px;">
                    <h5>최근 본 웹소설</h5>
                    <div class="row">
                        <div class="col-6 col-md-4 col-lg-3" th:each="item : ${recentItems}">
                            <div class="card mb-2" style="margin-bottom: 0;">
                                <img th:src="${item.img_name}" class="card-img-top" alt="웹소설 이미지" style="width: 100%; height: auto;"/>
                                <div class="card-body" style="padding: 10px;">
                                    <h6 class="card-title" th:text="${item.title}">웹소설 제목</h6>
                                    <p class="card-text" style="font-size: 0.8rem;">
                                        <small>작가: <span th:text="${item.writer}">작가 이름</span></small>
                                        <br/>
                                        <small>제공: <span th:text="${item.provider}">제공사</span></small>
                                        <br/>
                                        <small>카테고리: <span th:text="${item.categories}">카테고리</span></small>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 포럼 목록 섹션 -->
            <h5 th:if="${session.id != 'admin'}">Forums
                <a class="more-link" th:href="@{/user/profile/all/pazing/forum(type='forum', page=0)}">더보기</a>
            </h5>
            <div class="row" th:if="${session.id != 'admin'}">
                <div class="col-6 col-md-4 col-lg-3" th:each="forum, iterStat : ${forumList}" th:if="${iterStat.index < 4}">
                    <div class="card mb-3">
                        <div class="card-body">
                            <h6 class="card-title">
                                <a th:href="@{/forum/view(num=${forum.num})}" th:text="${forum.title}"></a>
                            </h6>
                            <p class="card-text" th:text="${forum.content}"></p>
                            <p class="card-text"><small>작성자: <span th:text="${forum.user_id}"></span></small></p>
                            <p class="card-text"><small>날짜: <span th:text="${forum.wdate}"></span></small></p>
                            <p class="card-text"><small>조회수: <span th:text="${forum.hitcount}"></span></small></p>
                            <!-- 숨겨진 num 값 -->
                            <input type="hidden" th:value="${forum.num}" />
                        </div>
                    </div>
                </div>
                <div th:if="${forumList.size() == 0}" class="col-6 col-md-4 col-lg-3">
                    <div class="card mb-3">
                        <div class="card-body text-center">
                            <p>포럼이 없습니다.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 리뷰 목록 섹션 -->
            <h5 th:if="${session.id != 'admin'}">Reviews
                <a class="more-link" th:href="@{/user/profile/all/pazing/review(type='review', page=0)}">더보기</a>
            </h5>
            <div class="row">
                <div class="col-6 col-md-4 col-lg-3" th:each="review, iterStat : ${reviewList}" th:if="${iterStat.index < 4}">
                    <div class="card mb-3">
                        <div class="card-body">
                            <h6 class="card-title">
                                <a th:href="@{/review/detail(num=${review.num})}" th:text="${review.title}"></a>
                            </h6>
                            <p class="card-text" th:text="${review.content}"></p>
                            <p class="card-text"><small>작성자: <span th:text="${review.user_id}"></span></small></p>
                            <p class="card-text"><small>날짜: <span th:text="${#dates.format(review.wdate, 'yyyy-MM-dd HH:mm:ss')}"></span></small></p>
                            <!-- 숨겨진 num 값 -->
                            <input type="hidden" th:value="${review.num}" />
                        </div>
                    </div>
                </div>
                <div th:if="${reviewList.size() == 0}" class="col-6 col-md-4 col-lg-3">
                    <div class="card mb-3">
                        <div class="card-body text-center">
                            <p>리뷰가 없습니다.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 게시판 목록 섹션 -->
            <h5 th:if="${session.id != 'admin'}">Boards
                <a class="more-link" th:href="@{/user/profile/all/pazing/board(type='board', page=0)}">더보기</a>
            </h5>
            <div class="row">
                <div class="col-6 col-md-4 col-lg-3" th:each="board, iterStat : ${boardList}" th:if="${iterStat.index < 4}">
                    <div class="card mb-3">
                        <div class="card-body">
                            <h6 class="card-title">
                                <a th:href="@{/b_selectOne(num=${board.num})}" th:text="${board.title}"></a>
                            </h6>
                            <p class="card-text" th:text="${board.content}"></p>
                            <p class="card-text"><small>작성자: <span th:text="${board.user_id}"></span></small></p>
                            <p class="card-text"><small>조회수: <span th:text="${board.boardhitcount}"></span></small></p>
                            <!-- 숨겨진 num 값 -->
                            <input type="hidden" th:value="${board.num}" />
                        </div>
                    </div>
                </div>
                <div th:if="${boardList.size() == 0}" class="col-6 col-md-4 col-lg-3">
                    <div class="card mb-3">
                        <div class="card-body text-center">
                            <p>게시판이 없습니다.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 댓글 목록 섹션 -->
            <h5 th:if="${session.id != 'admin'}">Comments
                <a class="more-link" th:href="@{/user/profile/all/pazing/comment(type='comment', page=0)}">더보기</a>
            </h5>
            <div class="row">
                <div class="col-6 col-md-4 col-lg-3" th:each="comment, iterStat : ${commentList}" th:if="${iterStat.index < 4}">
                    <div class="card mb-3">
                        <div class="card-body">
                            <!-- bnum에 데이터가 있으면 board 상세보기 링크 제공 -->
                            <h6 class="card-title" th:if="${comment.bnum != 0}">
                                <a th:href="@{/b_selectOne(num=${comment.bnum})}" th:text="'게시판'"></a>
                            </h6>

                            <!-- rnum에 데이터가 있으면 리뷰 상세보기 링크 제공 -->
                            <h6 class="card-title" th:if="${comment.rnum != 0}">
                                <a th:href="@{/review/detail(num=${comment.rnum})}" th:text="'리뷰'"></a>
                            </h6>

                            <!-- fnum에 데이터가 있으면 포럼 상세보기 링크 제공 -->
                            <h6 class="card-title" th:if="${comment.fnum != 0}">
                                <a th:href="@{/forum/view(num=${comment.fnum})}" th:text="'포럼'"></a>
                            </h6>

                            <p class="card-text" th:text="${comment.content}"></p>
                            <p class="card-text"><small>작성자: <span th:text="${comment.user_id}"></span></small></p>
                            <p class="card-text"><small>날짜: <span th:text="${#dates.format(comment.wdate, 'yyyy-MM-dd HH:mm:ss')}"></span></small></p>
                            <!-- 숨겨진 rnum, bnum, fnum 값 -->
                            <input type="hidden" th:value="${comment.bnum}" />
                            <input type="hidden" th:value="${comment.rnum}" />
                            <input type="hidden" th:value="${comment.fnum}" />
                        </div>
                    </div>
                </div>
                <div th:if="${commentList.size() == 0}" class="col-6 col-md-4 col-lg-3">
                    <div class="card mb-3">
                        <div class="card-body text-center">
                            <p>댓글이 없습니다.</p>
                        </div>
                    </div>
                </div>
            </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- 푸터 -->
<footer th:replace="~{footer :: footer}" class="mt-auto"></footer>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<!-- JavaScript 및 외부 라이브러리 로드 -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
<script src="/js/common.js"></script>
</body>
</html>
